## 目标
- 全站仅使用 Supabase 云端存储与读取（不再走本地演示）
- “保存到我的报告”后，列表与弹窗均展示云端的完整内容

## 必要前提
- Supabase 项目与前端配置有效：`SUPABASE_URL`、`SUPABASE_ANON_KEY` 正确
- 报表表结构与 RLS 策略允许登录用户插入/读取自己的数据

## 数据库准备（Supabase SQL）
1) 表结构（如已存在请对照校验字段）
```sql
create table if not exists public.reports (
  id uuid primary key default gen_random_uuid(),
  user_id uuid not null,
  title text not null,
  report_type text check (report_type in ('resume','interview')),
  content text,
  markdown_output text,
  is_starred boolean default false,
  created_at timestamptz default now()
);
```
2) 启用 RLS 并配置策略
```sql
alter table public.reports enable row level security;
create policy "select own" on public.reports for select using (auth.uid() = user_id);
create policy "insert own" on public.reports for insert with check (auth.uid() = user_id);
create policy "update own" on public.reports for update using (auth.uid() = user_id) with check (auth.uid() = user_id);
create policy "delete own" on public.reports for delete using (auth.uid() = user_id);
```

## 代码调整（云端唯一）
1) 登录要求
- 应用启动后若未登录 Supabase，强制弹出登录弹窗；所有保存/查看/列表操作在未登录时直接提示并引导登录

2) 保存仅写云端
- 在 `saveReportToSupabase(type)` 中：当 `window.Auth.supabase` 存在但未登录时，直接提示“请先登录”；移除本地 `localStorage` 保存分支
- 保留写入字段：`user_id、title、report_type、content、markdown_output、created_at`

3) 列表仅读云端
- 在 `loadMyReports()` 中：仅当“有 Supabase 客户端且用户已登录”时加载；未登录显示提示与登录入口，不再读取本地数据

4) 查看报告仅读云端
- `viewSavedReport/openReportModal`：始终生成 `report.html?report_id=<id>`（不再附带 `local=1`）
- `report.js`：移除本地兜底读取逻辑；若未登录则显示“请先登录”，登录后自动重试并拉取云端数据

5) 会话就绪处理
- 保留 `auth.getSession()` + `auth-changed` 一次性重试机制，确保登录完成后弹窗自动刷新内容

## 配置与持久化
- 前端 Supabase 配置通过 `window.__SUPABASE_CONFIG = { url, anonKey }` 注入或在现有 `supabase.js` 默认常量中使用你的项目参数；确保指向你的云端项目
- 登录 Supabase 后会在浏览器保持会话，不需要每次都重新登录（除非你主动退出或清理缓存）

## 验证流程
1) 登录 Supabase
2) 生成并点击“保存到我的报告”，提示成功
3) 打开“我的报告”列表，确认显示最新云端记录
4) 点击“查看报告”，弹窗展示完整 Markdown 内容
5) 测试“星标/删除/下载”，云端与弹窗行为一致

## 可选增强
- 提供“一键同步本地演示数据到云端”的迁移按钮（仅本次会话）
- 在导航处展示当前模式标签“云端”，提升状态可见性

## 风险与提示
- 若表/策略未创建或 RLS 不允许插入，会导致保存失败；请先执行上述 SQL
- 若你的 Supabase 项目使用自定义 schema 名称，需将代码中的 `public.reports` 对应修改

确认后，我将实施上述代码调整（禁用本地分支、强制云端逻辑），并按验证流程自测以确保“保存后可以查看完整报告”。